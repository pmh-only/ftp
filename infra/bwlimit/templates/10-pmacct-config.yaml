apiVersion: v1
kind: ConfigMap
metadata:
  name: pmacct-config
  namespace: bwlimit
data:
  pmacctd.conf: |
    daemonize: false
    pcap_interface: enp0s6
    pcap_filter: outbound and ip and not (dst net 10.0.0.0/8 or dst net 172.16.0.0/12 or dst net 192.168.0.0/16)

    plugins: nfprobe
    nfprobe_receiver: 127.0.0.1:2055
    nfprobe_version: 10

    # Reduce export latency (pmacct 1.7.7 style); tune as needed
    # expint = expiry interval (seconds)
    nfprobe_timeouts: expint=2:tcp=2:tcp.rst=2:tcp.fin=2:udp=2:icmp=2:general=2:maxlife=2
    nfprobe_dont_cache: true

    # Keep aggregation minimal to control volume
    aggregate: dst_host
